Description: Fixes rounding issues in vis.c
 This patches fixes two rounding issues in vis.c for sending and purging vis
 packets. Before, the timers and timeouts always got rounded down to seconds,
 though we want a precision in milliseconds.
 .
 This also fixes a kernel panic that occures when lowering the timer for
 sending vis packets (vis_interval) to less than 1000ms in main.c manually.
Origin: upstream, http://open-mesh.net/changeset/1506
Author: Linus LÃ¼ssing <linus.luessing@web.de>

---
diff --git a/vis.c b/vis.c
index f6c9acb289ed9cdc5e30bca3d51c8dccd8012c47..9ac352a590d295b0e05128ed0f6d2456c51ff884 100644
--- a/vis.c
+++ b/vis.c
@@ -379,7 +379,7 @@ static void purge_vis_packets(void)
 		if (info == my_vis_info)	/* never purge own data. */
 			continue;
 		if (time_after(jiffies,
-			       info->first_seen + (VIS_TIMEOUT/1000)*HZ)) {
+			       info->first_seen + (VIS_TIMEOUT*HZ)/1000)) {
 			hash_remove_bucket(vis_hash, hashit);
 			free_info(info);
 		}
@@ -559,6 +559,6 @@ void vis_quit(void)
 static void start_vis_timer(void)
 {
 	queue_delayed_work(bat_event_workqueue, &vis_timer_wq,
-			   (atomic_read(&vis_interval)/1000) * HZ);
+			   (atomic_read(&vis_interval) * HZ ) / 1000);
 }
 
